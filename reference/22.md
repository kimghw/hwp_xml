# 아래한글 HWPX XML 사용 방법 및 매뉴얼 종합 보고서

---

## 목차

1. [HWPX 파일 형식 개요](#1-hwpx-파일-형식-개요)
2. [HWPX 내부 구조](#2-hwpx-내부-구조)
3. [XML 태그 및 스키마](#3-xml-태그-및-스키마)
4. [HWP vs HWPX 비교](#4-hwp-vs-hwpx-비교)
5. [Python 라이브러리](#5-python-라이브러리)
6. [Java 라이브러리](#6-java-라이브러리)
7. [JavaScript/Node.js 라이브러리](#7-javascriptnodejs-라이브러리)
8. [HWPX 생성 및 편집 방법](#8-hwpx-생성-및-편집-방법)
9. [변환 도구](#9-변환-도구)
10. [공식 리소스 및 문서](#10-공식-리소스-및-문서)
11. [GitHub 레포지토리](#11-github-레포지토리)
12. [실용적인 코드 예제](#12-실용적인-코드-예제)
13. [실무 활용 사례](#13-실무-활용-사례)
14. [주요 제한사항 및 주의사항](#14-주요-제한사항-및-주의사항)

---

## 1. HWPX 파일 형식 개요

### 1.1 정의

**HWPX**는 한글과컴퓨터에서 개발한 **개방형 XML 기반 문서 포맷**입니다. 한글(HWP) 문서의 콘텐츠를 표현할 수 있는 **OWPML(Open Word-Processor Markup Language)**로 개발된 파일 형식입니다.

| 항목 | 내용 |
|------|------|
| **정의** | 한컴오피스 한글의 XML 기반 개방형 문서 형식 |
| **표준** | OWPML (KS X 6101 국가표준) |
| **제정일** | 2011년 12월 30일 한국산업표준(KS)으로 제정 |
| **기본 포맷 채택** | 2021년 4월 15일 패치부터 한글의 기본 저장 형식으로 변경 |
| **파일 구조** | ZIP 압축 컨테이너 내 XML 파일들 |
| **지원 버전** | 한글 2010 SE+ (필터 실행 가능), 한글 2014 VP+ (완전 지원) |
| **MIME 타입** | application/hwp+zip |
| **확장자** | .hwpx |

### 1.2 주요 특징

1. **개방성**: XML 기반으로 누구나 내용을 읽고 분석 가능
2. **호환성**: 다양한 시스템 및 도구에서 재가공/재수정 가능
3. **보존성**: 장기 보존에 적합한 표준 포맷
4. **데이터 활용**: 기계 판독 가능(Machine Readable)하여 빅데이터/AI 분석에 활용 가능
5. **복구 가능성**: 일부 파일 손상 시에도 나머지 요소로 복구 가능

---

## 2. HWPX 내부 구조

### 2.1 전체 파일 구조

HWPX 파일은 ZIP 압축 파일로, 확장자를 `.zip`으로 변경하면 내부 구조를 확인할 수 있습니다.

```
[파일명].hwpx (ZIP 압축 파일)
│
├── mimetype                    # HWPX 포맷 시그니처 (application/hwp+zip)
├── version.xml                 # OWPML 버전 정보, 저장 환경 정보
├── settings.xml                # 외부 설정 정보 (커서 위치 등)
│
├── BinData/                    # 바이너리 데이터 폴더
│   ├── image1.png              # 이미지 파일
│   ├── image2.jpg
│   └── ...
│
├── Contents/                   # 문서 핵심 내용 폴더 (가장 중요)
│   ├── content.hpf             # 패키징 파일 목록 (OPF 표준)
│   ├── header.xml              # 문서 설정 및 스타일 정보
│   ├── section0.xml            # 본문 내용 (구역 1)
│   ├── section1.xml            # 본문 내용 (구역 2)
│   └── ...
│
├── META-INF/                   # 메타데이터 폴더
│   ├── container.xml           # 컨테이너 구성 정보
│   ├── container.rdf           # 컨테이너 설명
│   └── manifest.xml            # 파일 매니페스트 (암호화 정보 포함)
│
├── Preview/                    # 미리보기 폴더
│   ├── PrvImage.png            # 미리보기 이미지
│   └── PrvText.txt             # 미리보기 텍스트
│
└── Scripts/                    # 스크립트 폴더
    ├── headerScripts.js        # 헤더 스크립트
    └── sourceScripts.js        # 소스 스크립트
```

### 2.2 주요 파일 상세 설명

#### 루트 레벨 파일

| 파일 | 설명 |
|------|------|
| **mimetype** | HWPX 포맷임을 확인하는 시그니처 정보. 내용: `application/hwp+zip` |
| **version.xml** | OWPML 파일 형식 버전 정보. 문서를 저장한 환경 정보 포함 |
| **settings.xml** | 외부 설정 요소 정보. 저장 시점의 커서 위치 정보(CaretPosition) 저장 |

#### version.xml 주요 속성

| 속성 | 설명 |
|------|------|
| `targetApplication` | 문서 유형 (WORDPROCESSOR, PRESENTATION, SPREADSHEET) |
| `major`, `minor`, `micro` | 버전 번호 |
| `buildNumber`, `os` | 빌드 및 운영체제 정보 |
| `application`, `appVersion` | 애플리케이션 정보 |

#### Contents 폴더 (핵심)

| 파일 | 설명 |
|------|------|
| **content.hpf** | OPF 표준에 따른 패키징 파일 목록. metadata, manifest, spine으로 구성 |
| **header.xml** | 문서의 전반적인 설정과 모양 속성 (글꼴, 글자 모양, 문단 모양, 스타일 등) |
| **section0.xml** | 구역별 본문 내용. 문서의 실제 텍스트, 표, 이미지 등 포함 |

#### header.xml 주요 요소

| 요소 | 설명 |
|------|------|
| `<hh:beginNum>` | 각 객체 시작 번호 (페이지, 각주, 미주, 그림, 표, 수식) |
| `<hh:fontfaces>` | 폰트 정의 (언어별: HANGUL, LATIN, HANJA 등) |
| `<hh:borderFills>` | 테두리 및 배경 스타일 |
| `<hh:charProperties>` | 글자 모양 정의 |
| `<hh:paraProperties>` | 문단 모양 정의 |
| `<hh:tabProperties>` | 탭 설정 |
| `<hh:numberings>` | 번호 매기기 설정 |
| `<hh:styles>` | 스타일 정의 |

---

## 3. XML 태그 및 스키마

### 3.1 XML 네임스페이스

HWPX 문서는 다양한 XML 네임스페이스를 사용합니다:

| 접두사 | 네임스페이스 URI | 용도 |
|--------|------------------|------|
| `hp` | `http://www.hancom.co.kr/hwpml/2011/paragraph` | 문단, 텍스트, 런 |
| `hp10` | `http://www.hancom.co.kr/hwpml/2016/paragraph` | 문단 (2016 버전) |
| `hh` | `http://www.hancom.co.kr/hwpml/2011/head` | 헤더 정보 |
| `hs` | `http://www.hancom.co.kr/hwpml/2011/section` | 섹션 |
| `hc` | `http://www.hancom.co.kr/hwpml/2011/core` | 코어 요소 |
| `ha` | `http://www.hancom.co.kr/hwpml/2011/app` | 애플리케이션 |
| `hm` | `http://www.hancom.co.kr/hwpml/2011/master-page` | 마스터 페이지 |
| `hhs` | `http://www.hancom.co.kr/hwpml/2011/history` | 변경 이력 |
| `hpf` | `http://www.hancom.co.kr/schema/2011/hpf` | HPF 스키마 |

> **참고**: 문서 버전에 따라 네임스페이스가 달라질 수 있으므로, 파싱 시 동적으로 추출하는 것이 권장됩니다.

### 3.2 문단 및 텍스트 구조 (section.xml)

문서의 계층 구조: **본문 → 구역(sec) → 문단(p) → 런(run) → 텍스트(t)**

```xml
<hp:sec>
  <hp:p id="0" paraPrIDRef="0" styleIDRef="0">
    <hp:run charPrIDRef="0">
      <hp:t>텍스트 내용</hp:t>
    </hp:run>
  </hp:p>
</hp:sec>
```

| 태그 | 설명 | 주요 속성 |
|------|------|-----------|
| `<hp:sec>` | 구역 (Section) | 페이지 설정, 단 설정 등 |
| `<hp:p>` | 문단 (Paragraph) | `id`, `paraPrIDRef`(문단 모양 참조), `styleIDRef`(스타일 참조) |
| `<hp:run>` | 텍스트 런 (같은 글자 모양 구간) | `charPrIDRef`(글자 모양 참조) |
| `<hp:t>` | 실제 텍스트 내용 | 텍스트 데이터 |
| `<hp:linesegarray>` | 줄 나눔 정보 | 줄바꿈 위치 |
| `<hp:lineseg>` | 개별 줄 정보 | `textpos`(텍스트 위치) |

### 3.3 표 (Table) 구조

```xml
<hp:tbl id="1" zOrder="0" numberingType="TABLE" rowCnt="3" colCnt="4"
        cellSpacing="0" borderFillIDRef="2">
  <hp:tr>
    <hp:tc>
      <hp:subList>
        <hp:p>
          <hp:run>
            <hp:t>셀 내용</hp:t>
          </hp:run>
        </hp:p>
      </hp:subList>
    </hp:tc>
    <hp:tc>...</hp:tc>
  </hp:tr>
  <hp:tr>...</hp:tr>
</hp:tbl>
```

| 태그 | 설명 | 주요 속성 |
|------|------|-----------|
| `<hp:tbl>` | 표 전체 | `id`, `rowCnt`(행 수), `colCnt`(열 수), `cellSpacing`(셀 간격), `borderFillIDRef`(테두리 참조), `pageBreak`, `repeatHeader` |
| `<hp:tr>` | 표 행 (Table Row) | - |
| `<hp:tc>` | 표 셀 (Table Cell) | - |
| `<hp:subList>` | 셀 내부 콘텐츠 컨테이너 | - |

### 3.4 이미지 및 바이너리 데이터

이미지는 **BinData 폴더**에 실제 파일로 저장되고, 본문 XML에서 참조합니다.

| 요소 | 설명 |
|------|------|
| `BinData/` 폴더 | 실제 이미지 파일 저장 (PNG, JPG, BMP 등) |
| `<hp:pic>` | 그림 객체 태그 |
| `binDataIDRef` 속성 | BinData 폴더 내 파일 참조 |

### 3.5 header.xml 구조 예시

```xml
<hh:head>
  <hh:beginNum page="1" footnote="1" endnote="1" pic="1" tbl="1" equation="1"/>
  <hh:refList>
    <hh:fontfaces>
      <hh:fontface lang="HANGUL">
        <hh:font face="함초롬돋움" type="TTF"/>
      </hh:fontface>
      <hh:fontface lang="LATIN">...</hh:fontface>
    </hh:fontfaces>
    <hh:borderFills>...</hh:borderFills>
    <hh:charProperties>
      <hh:charPr id="0">
        <!-- 글자 크기, 굵기, 기울임, 밑줄 등 -->
      </hh:charPr>
    </hh:charProperties>
    <hh:paraProperties>
      <hh:paraPr id="0">
        <!-- 문단 정렬, 들여쓰기, 줄간격 등 -->
      </hh:paraPr>
    </hh:paraProperties>
    <hh:tabProperties>...</hh:tabProperties>
    <hh:numberings>...</hh:numberings>
    <hh:styles>...</hh:styles>
  </hh:refList>
</hh:head>
```

### 3.6 content.hpf 구조

OPF(Open Packaging Format) 표준에 따라 구성됩니다.

```xml
<opf:package>
  <opf:metadata>
    <!-- 작성자, 제목, 생성 날짜 등 메타데이터 -->
  </opf:metadata>
  <opf:manifest>
    <!-- 패키지 구성 파일 목록 -->
    <opf:item id="header" href="header.xml"/>
    <opf:item id="section0" href="section0.xml"/>
  </opf:manifest>
  <opf:spine>
    <!-- 문서 내부 구조 정의 (순서 중요) -->
  </opf:spine>
</opf:package>
```

---

## 4. HWP vs HWPX 비교

### 4.1 기술적 비교

| 구분 | HWP | HWPX |
|------|-----|------|
| **파일 형식** | 바이너리 (CFB: Compound File Binary) | XML 기반 |
| **압축 구조** | Microsoft CFB | ZIP 압축 |
| **데이터 접근성** | 별도 분석 과정 필요 | 기계 판독 가능 (Machine Readable) |
| **확장자 변경** | 불가 | .hwpx → .zip으로 변경하여 압축 해제 가능 |
| **개방성** | 폐쇄형 | 개방형 (국가표준 KS X 6101) |
| **복구 가능성** | 낮음 (일부 손상 시 전체 복구 어려움) | 높음 (일부 요소만 손상되어도 나머지 복구 가능) |

### 4.2 HWP 형식의 장단점

#### 장점
- 한컴오피스에서 모든 기능 완벽 지원
- 상대적으로 작은 파일 크기로 빠른 전송 가능
- 강력한 문서 보안 설정 지원
- 오랜 기간 축적된 문서 자료와의 호환성

#### 단점
- 바이너리 형식으로 타 프로그램 호환성 문제
- 파일 일부 손상 시 전체 문서 복구 어려움
- OLE 개체, 플래시 취약점 등 악성코드 공격 대상
- 별도의 분석 과정 없이 데이터 추출 불가능

### 4.3 HWPX 형식의 장단점

#### 장점
- XML 기반으로 누구나 구조 분석 가능
- 별도 처리 없이 데이터 분류/추출 가능
- 일부 파일 손상 시에도 나머지 요소로 복구 가능
- 기계판독형으로 빅데이터 분석 및 AI 활용 용이
- 클라우드 환경에서의 문서 공유, 협업에 적합
- KS X 6101 국가 표준 준수

#### 단점
- 한글 2010 이하 버전에서 열기 불가
- 일부 관공서 시스템에서 인식 안됨
- 매크로, 특수 서식 사용 시 제약 존재
- 일부 뷰어에서 지원 미흡 (안드로이드 한컴오피스 뷰어 등)

### 4.4 버전별 지원 현황

| 버전 | HWP 지원 | HWPX 지원 | 비고 |
|------|---------|----------|------|
| 한글 2010 SE+ | O | O (필터 실행) | 기본적인 HWPX 열기 가능 |
| 한글 2014 VP | O | O | 하위 호환성 이슈 대응 반영 |
| 한글 NEO | O | O | 완전 지원 |
| 한글 2020 이상 | O | O | 기본 저장 형식으로 HWPX 설정 |
| 한글 2010 이하 | O | X | HWPX 파일 열기 불가 |

---

## 5. Python 라이브러리

### 5.1 라이브러리 비교표

| 라이브러리 | 플랫폼 | HWP | HWPX | 한글 필요 | 주요 용도 |
|-----------|--------|-----|------|----------|----------|
| **pyhwpx** | Windows | O | O | O | 문서 자동화, 편집 |
| **python-hwpx** | 크로스 플랫폼 | X | O | X | HWPX 직접 조작 |
| **pyhwp** | 크로스 플랫폼 | O | X | X | 텍스트 추출, 변환 |
| **libhwp** | 크로스 플랫폼 | O | X | X | 고성능 파싱, 데이터 추출 |
| **olefile** | 크로스 플랫폼 | O | X | X | 저수준 바이너리 파싱 |
| **zipfile+ET** | 크로스 플랫폼 | X | O | X | HWPX XML 파싱 |

### 5.2 pyhwpx (Windows 전용, 한글 설치 필요)

pywin32를 사용하여 HwpAutomation API를 래핑한 고수준 라이브러리입니다.

#### 설치

```bash
# 기본 설치
pip install pyhwpx

# 업데이트
pip install --upgrade pyhwpx

# 내부망 설치 (오프라인)
# 1. 외부망에서 다운로드
pip download pyhwpx jupyter

# 2. 내부망에서 설치
pip install --no-index --find-links=. pyhwpx jupyter
```

#### 요구사항
- Windows OS
- Python 3.10 이상
- 아래아한글 프로그램 설치
- pywin32 (`pip install pywin32`)

#### 기본 사용법

```python
from pyhwpx import Hwp

# 한/글 실행 (기존 창에 연결)
hwp = Hwp()

# 새 창으로 한/글 실행
hwp = Hwp(new=True)

# 텍스트 입력
hwp.insert_text("안녕하세요")
hwp.insert_text("줄바꿈\r\n")

# 표 생성 (5행 5열)
hwp.create_table(5, 5, treat_as_char=True)

# 표를 데이터프레임으로 변환
df = hwp.table_to_df()

# 데이터를 표로 변환
hwp.table_from_data(data)  # dict, list, DataFrame, Excel, CSV 지원

# 필드 관련
fields_dict = hwp.fields_to_dict()  # 필드명과 값을 dict로 변환

# n번째 표로 이동
hwp.get_into_nth_table(n)

# 저장
hwp.save_as("output.hwpx")
```

#### 주요 특징
- 보안모듈 설치 및 실행 자동 처리
- 기존 열린 한/글 창 자동 연결
- 레지스트리 등록이나 RegisterModule 메서드 별도 실행 불필요

### 5.3 python-hwpx (크로스 플랫폼)

한글 프로그램 없이도 HWPX 파일을 직접 조작할 수 있는 라이브러리입니다.

#### 설치

```bash
pip install python-hwpx
```

#### 기본 사용 예제

```python
from io import BytesIO
from hwpx.document import HwpxDocument
from hwpx.templates import blank_document_bytes

# 빈 문서 생성
source = BytesIO(blank_document_bytes())
document = HwpxDocument.open(source)

# 문단 추가
section = document.sections[0]
paragraph = document.add_paragraph("자동 생성 텍스트", section=section)

# 표 생성 및 셀 텍스트 설정
table = document.add_table(rows=2, cols=2, section=section)
table.set_cell_text(0, 0, "항목")
table.set_cell_text(0, 1, "값")
table.set_cell_text(1, 0, "데이터1")
table.set_cell_text(1, 1, "100")

# 메모 추가
document.add_memo_with_anchor("검토 필요", paragraph=paragraph, memo_shape_id_ref="0")

# 저장
document.save("output.hwpx")
```

### 5.4 pyhwp (크로스 플랫폼)

HWPv5 파일 형식 파서입니다.

#### 설치

```bash
pip install pyhwp
```

#### 주요 명령어 도구

| 명령어 | 설명 |
|--------|------|
| `hwp5txt` | HWP를 텍스트로 변환 |
| `hwp5html` | HWP를 HTML로 변환 |
| `hwp5odt` | HWP를 ODT로 변환 |
| `hwp5proc` | HWPv5 처리기 (다양한 작업) |

#### 사용법

```bash
# 커맨드라인에서 텍스트 추출
hwp5txt --output "result.txt" "문서.hwp"

# hwp5proc 명령어
hwp5proc version 파일.hwp   # 버전 확인
hwp5proc header 파일.hwp    # 헤더 정보
hwp5proc ls 파일.hwp        # 내부 구조 목록
hwp5proc cat 파일.hwp       # 내용 출력
hwp5proc xml 파일.hwp       # XML로 변환
hwp5proc unpack 파일.hwp    # 압축 해제
```

```python
# Python 코드에서 사용
from subprocess import Popen, PIPE

file = '문서.hwp'
process = Popen(['hwp5txt', file], stdout=PIPE, stderr=PIPE)
stdout, stderr = process.communicate()
text = stdout.decode('utf-8')
print(text)
```

### 5.5 libhwp (Rust 기반 고성능 라이브러리)

Rust로 작성된 고성능 Python HWP 리더 라이브러리입니다.

#### 설치

```bash
pip install libhwp
```

#### 사용법

```python
from libhwp import HWPReader

# 파일 열기
hwp = HWPReader('문서.hwp')

# 모든 문단 출력 (표, 캡션 포함)
for paragraph in hwp.find_all('paragraph'):
    print(paragraph)

# 표 내용 출력 (표 안의 표 포함)
for table in hwp.find_all('table'):
    for cell in table.cells:
        for paragraph in cell.paragraphs:
            print(paragraph)

# 수식 내용 출력
for equation in hwp.find_all('equation'):
    print(equation.script)  # 예: f(x)= logx+sinx

# 문서에 사용된 파일(이미지 등) 저장
for file in hwp.bin_data:
    with open(file.name, 'wb') as f:
        f.write(file.data)
```

### 5.6 olefile (저수준 OLE 파싱)

Microsoft OLE 파일 구조를 파싱하는 라이브러리입니다.

#### 설치

```bash
pip install olefile
```

#### 간단한 텍스트 추출 (PrvText - 제한적)

```python
import olefile

f = olefile.OleFileIO('문서.hwp')
encoded_text = f.openstream('PrvText').read()
text = encoded_text.decode('UTF-16')
print(text)
```

> **주의**: PrvText는 미리보기용으로 약 2페이지까지만 추출됩니다.

#### 전체 텍스트 추출 (BodyText 섹션)

```python
import olefile
import zlib
import struct

def get_hwp_text(filename):
    f = olefile.OleFileIO(filename)
    dirs = f.listdir()

    # HWP 파일 검증
    if ["FileHeader"] not in dirs or \
       ["\x05HwpSummaryInformation"] not in dirs:
        raise Exception("Not Valid HWP.")

    # 압축 여부 확인
    header = f.openstream("FileHeader")
    header_data = header.read()
    is_compressed = (header_data[36] & 1) == 1

    # Body Sections 목록
    nums = []
    for d in dirs:
        if d[0] == "BodyText":
            nums.append(int(d[1][len("Section"):]))
    sections = ["BodyText/Section" + str(x) for x in sorted(nums)]

    # 텍스트 추출
    text = ""
    for section in sections:
        bodytext = f.openstream(section)
        data = bodytext.read()

        if is_compressed:
            unpacked_data = zlib.decompress(data, -15)
        else:
            unpacked_data = data

        i = 0
        size = len(unpacked_data)
        while i < size:
            header = struct.unpack_from("<I", unpacked_data, i)[0]
            rec_type = header & 0x3ff
            rec_len = (header >> 20) & 0xfff

            if rec_type in [67]:  # 텍스트 레코드
                rec_data = unpacked_data[i+4:i+4+rec_len]
                text += rec_data.decode('utf-16')
            i += 4 + rec_len

    return text

# 사용
text = get_hwp_text('문서.hwp')
print(text)
```

### 5.7 HWPX 직접 파싱 (Python 표준 라이브러리)

별도 라이브러리 없이 Python 내장 라이브러리만으로 HWPX 파싱이 가능합니다.

```python
import zipfile
import xml.etree.ElementTree as ET
from io import BytesIO

# Namespace 추출 함수
def extract_namespaces(xml_bytes):
    events = ('start-ns',)
    namespaces = {}
    for _, elem in ET.iterparse(BytesIO(xml_bytes), events):
        prefix, uri = elem
        namespaces[prefix] = uri
    return namespaces

# HWPX 파일 열기
file_path = '문서.hwpx'
zipf = zipfile.ZipFile(file_path, 'r')

# 파일 목록 확인
print(zipf.namelist())

# header.xml 파싱
if 'Contents/header.xml' in zipf.namelist():
    header_bytes = zipf.read('Contents/header.xml')
    ns = extract_namespaces(header_bytes)
    header = ET.parse(BytesIO(header_bytes)).getroot()

    # 구역 수 확인
    sec_cnt = header.get('secCnt')
    print(f"구역 수: {sec_cnt}")

# section0.xml에서 본문 추출
if 'Contents/section0.xml' in zipf.namelist():
    section_bytes = zipf.read('Contents/section0.xml')
    section = ET.parse(BytesIO(section_bytes)).getroot()
    # XML 파싱 진행...

zipf.close()
```

### 5.8 선택 가이드

| 상황 | 추천 라이브러리 |
|------|----------------|
| Windows에서 한글 자동화 | **pyhwpx** |
| 크로스 플랫폼 HWPX 편집 | **python-hwpx** |
| Linux/macOS에서 HWP 텍스트 추출 | **libhwp** 또는 **pyhwp** |
| HWPX만 간단히 처리 | **zipfile + xml.etree** 또는 **BeautifulSoup** |
| 저수준 HWP 바이너리 분석 | **olefile** |

---

## 6. Java 라이브러리

### 6.1 hwpxlib (HWPX 파일용)

HWPX 파일을 Java에서 읽고 쓸 수 있는 라이브러리입니다.

#### Maven 의존성

```xml
<dependency>
    <groupId>kr.dogfoot</groupId>
    <artifactId>hwpxlib</artifactId>
</dependency>
```

#### 주요 유틸리티 클래스
- **BlankFileMaker**: 새로운 빈 HWPX 파일 생성
- **TextExtractor**: 문서에서 텍스트 콘텐츠 추출
- **ObjectFinder**: 문서 내 특정 객체를 찾는 기능

#### 관련 라이브러리
- [hwpxlib_ext](https://github.com/neolord0/hwpxlib_ext): 암호화된 HWPX 파일 처리 등 확장 기능
- [hwp2hwpx](https://github.com/neolord0/hwp2hwpx): HWP를 HWPX로 변환

### 6.2 hwplib (HWP 바이너리 파일용)

HWP 바이너리 파일을 위한 Java 라이브러리입니다.

#### Maven 의존성

```xml
<dependency>
    <groupId>kr.dogfoot</groupId>
    <artifactId>hwplib</artifactId>
</dependency>
```

#### 주요 기능
- 한글 파일을 객체로 읽기 및 파일로 저장
- 텍스트 추출 (문단 번호/글머리표 포함)
- 필드 텍스트 추출/설정
- 표 삽입, 셀 합치기, 행 삭제
- 이미지 삽입, 하이퍼링크 삽입
- 페이지 크기 변경
- 폰트 크기, 밑줄 등 글자 모양 설정

---

## 7. JavaScript/Node.js 라이브러리

### 7.1 @ssabrojs/hwpxjs

HWPX 파싱, HTML 변환, 텍스트 추출 기능을 제공합니다.

#### 설치

```bash
npm install @ssabrojs/hwpxjs
```

#### CLI 사용 예시

```bash
hwpxjs html document.hwpx > output.html
hwpxjs convert:hwp document.hwp converted.hwpx
hwpxjs txt document.hwpx > extracted.txt
```

### 7.2 기타 JavaScript 라이브러리

| 라이브러리 | 기능 | npm |
|-----------|------|-----|
| **node-hwp** | HWP 라이브러리 | [123jimin/node-hwp](https://github.com/123jimin/node-hwp) |
| **@ohah/hwpjs** | JSON/Markdown 변환, 이미지 추출 | [ohah/hwpjs](https://github.com/ohah/hwpjs) |
| **hwp.js** | 웹 기반 HWP 뷰어/파서 | [hahnlee/hwp.js](https://github.com/hahnlee/hwp.js) |

---

## 8. HWPX 생성 및 편집 방법

### 8.1 pyhwpx를 이용한 문서 자동화 (Windows)

#### 텍스트 입력

```python
from pyhwpx import Hwp

hwp = Hwp()

# 텍스트 삽입
hwp.insert_text("Hello world!")

# 줄바꿈이 포함된 텍스트
hwp.insert_text("첫번째 줄\r\n두번째 줄\r\n세번째 줄")

# 탭 문자 사용
hwp.insert_text("이름\t나이\t직업")
```

#### 표 생성

```python
from pyhwpx import Hwp

hwp = Hwp()

# 5행 5열 표 생성 (글자처럼 취급 옵션)
hwp.create_table(5, 5, treat_as_char=True)

# 표 안에 데이터 채우기
for i in range(25):
    hwp.insert_text(i)
    hwp.TableRightCell()  # 다음 셀로 이동
```

#### 표 생성 및 이미지 채우기

```python
from pyhwpx import Hwp

hwp = Hwp()

for i in range(2):
    hwp.insert_lorem(1)  # 아무 텍스트 삽입
    hwp.create_table(2, 6)  # 2행 6열 표 삽입
    while True:
        hwp.insert_random_picture()  # 랜덤 이미지 삽입
        if not hwp.TableRightCell():
            break  # 모든 셀에 채우기
    hwp.MoveRight()  # 표 우측으로 나가서
    hwp.BreakPara()  # 줄바꿈
```

#### 새 문서 생성 및 저장

```python
from pyhwpx import Hwp

hwp = Hwp()
hwp.NewDocument()  # 새 문서 생성

# 내용 작성
hwp.insert_text("새로운 문서입니다.")
hwp.create_table(3, 3)

# 저장
hwp.SaveAs("output.hwpx")
```

### 8.2 템플릿 기반 문서 생성 (필드 활용)

```python
from pyhwpx import Hwp

hwp = Hwp()
hwp.open("template.hwp")

# 딕셔너리로 필드에 데이터 삽입
data = {
    "이름": "홍길동",
    "부서": "개발팀",
    "날짜": "2025-01-23"
}
hwp.put_field_text(data)
hwp.save_as("output.hwp")
```

### 8.3 엑셀 연동 대량 문서 생성

```python
from pyhwpx import Hwp
import pandas as pd

hwp = Hwp()
hwp.open("template.hwp")

# 엑셀 데이터 로드
df = pd.read_excel("data.xlsx")

# 데이터 행 수만큼 템플릿 복사
hwp.SelectAll()
hwp.Copy()
for _ in range(len(df)):
    hwp.Paste()

# 필드에 데이터 일괄 삽입
hwp.put_field_text(df)
hwp.save_as("merged_output.hwp")
```

### 8.4 BeautifulSoup을 이용한 HWPX 표 추출

```python
import zipfile
from bs4 import BeautifulSoup
import pandas as pd

# HWPX 파일 열기
with zipfile.ZipFile('문서.hwpx', 'r') as zf:
    section_xml = zf.read('Contents/section0.xml')

# BeautifulSoup으로 파싱
soup = BeautifulSoup(section_xml, 'xml')

# 모든 표 추출
tables = soup.find_all('hp:tbl')

for table in tables:
    rows = table.find_all('hp:tr')
    for row in rows:
        cells = row.find_all('hp:tc')
        row_data = [cell.get_text(strip=True) for cell in cells]
        print(row_data)
```

### 8.5 표를 DataFrame으로 변환 후 CSV 저장

```python
from bs4 import BeautifulSoup
import pandas as pd
import zipfile

def hwpx_to_csv(hwpx_path, output_csv):
    # HWPX 파일을 ZIP으로 열고 section0.xml 추출
    with zipfile.ZipFile(hwpx_path, 'r') as zipf:
        xml_data = zipf.read('Contents/section0.xml').decode('utf-8')

    soup = BeautifulSoup(xml_data, "lxml-xml")
    tables = soup.find_all("hp:tbl")

    table_data = []
    for table in tables:
        rows = table.find_all("hp:tr")
        for row in rows:
            row_data = []
            cells = row.find_all("hp:tc")
            for cell in cells:
                text = cell.get_text(strip=True)
                row_data.append(text)
            table_data.append(row_data)

    df = pd.DataFrame(table_data)
    df.to_csv(output_csv, index=False)
    return df

# 사용
df = hwpx_to_csv('문서.hwpx', 'output.csv')
print(df)
```

---

## 9. 변환 도구

### 9.1 공식 및 상용 도구

| 도구 | 지원 변환 | 설명 |
|------|----------|------|
| **한글 프로그램** | HWP, HWPX, DOCX, PDF, TXT, HTML 등 | 가장 확실한 방법 |
| **한컴오피스 한PDF** | hwp, hwpx, docx, xlsx, pptx → pdf, hwp, hwpx 등 | 다양한 형식 지원 |
| **한컴 DocsConverter API** | hwp, hwpx → PDF, 이미지, HTML | 공식 API 서비스 |
| **한글 SDK** | HWP/HWPX → HTML, PDF 등 | 개발용 라이브러리 |

### 9.2 온라인 변환 도구 (무료)

| 도구 | 지원 변환 | 웹사이트 |
|------|----------|----------|
| **PolarisOffice Tools** | HWPX → HWP, PDF, JPG | polarisofficetools.com |
| **Vertopal** | HWPX → PDF | vertopal.com |
| **ONLYOFFICE** | HWP, HWPX, DOCX, PDF 등 | onlyoffice.com |
| **CloudConvert** | HWP → PDF, DOC | cloudconvert.com |
| **AnyConv** | HWP → DOCX, PDF | anyconv.com |
| **Allinpdf** | HWP ↔ PDF | allinpdf.com |
| **PDF Candy** | HWP → PDF | pdfcandy.com |

### 9.3 오픈소스 변환 도구

| 도구 | 언어 | 기능 |
|------|------|------|
| **hwp2hwpx** | Java | HWP → HWPX 변환 |
| **H2Orestart** | Java | LibreOffice 확장, HWPX → ODT 변환 |
| **@ssabrojs/hwpxjs** | JavaScript | HWP → HWPX, HWPX → HTML |

### 9.4 LibreOffice + H2Orestart

LibreOffice에서 HWP 및 HWPX 파일을 읽고 편집할 수 있는 확장 프로그램입니다.

```bash
# LibreOffice headless PDF 변환
libreoffice --headless --convert-to pdf document.hwpx
```

### 9.5 변환 방법 요약

#### HWPX에서 다른 형식으로 변환

| 변환 대상 | 추천 방법 |
|----------|----------|
| **PDF** | 한글 프로그램, PolarisOffice Tools, LibreOffice + H2Orestart |
| **DOCX** | 한글 프로그램, ONLYOFFICE, 한컴 DocsConverter API |
| **HTML** | hwpxjs (Node.js), 한컴 DocsConverter API |
| **HWP** | PolarisOffice Tools, 한글 프로그램 |
| **ODT** | LibreOffice + H2Orestart |
| **텍스트** | hwpxjs, pyhwpx, Python zipfile + XML 파싱 |

#### 다른 형식에서 HWPX로 변환

| 원본 형식 | 추천 방법 |
|----------|----------|
| **HWP** | 한글 프로그램, hwp2hwpx (Java), hwpxjs |
| **DOCX** | 한글 프로그램 |
| **PDF** | 한컴오피스 한PDF, Allinpdf |

### 9.6 한글 프로그램에서 기본 저장 형식 변경

1. 한글 프로그램 실행
2. `도구` → `환경 설정` → `파일` 탭
3. `기본 문서 형식`에서 원하는 형식 선택
4. 확인 후 적용

---

## 10. 공식 리소스 및 문서

### 10.1 한컴 공식 리소스

| 리소스 | URL |
|--------|-----|
| **한컴 공식 홈페이지** | https://www.hancom.com |
| **한컴테크 기술 블로그** | https://tech.hancom.com |
| **한컴디벨로퍼 (개발자 포털)** | https://developer.hancom.com |
| **한컴디벨로퍼 영문** | https://developer.hancom.com/en-us |
| **한컴디벨로퍼 포럼** | https://forum.developer.hancom.com |
| **한컴 공식 GitHub** | https://github.com/hancom-io |
| **HWP/OWPML 스펙 다운로드** | https://www.hancom.com/support/downloadCenter/hwpOwpml |
| **한글 SDK** | https://www.hancom.com/product/sdk/hwpSdk |
| **SDK 포털** | https://sdk.hancom.com |

### 10.2 기술 문서

| 문서 | URL | 설명 |
|------|-----|------|
| **HWPX 포맷 구조 살펴보기** | https://tech.hancom.com/hwpxformat/ | HWPX 파일 구조 상세 설명 |
| **Python을 통한 HWPX 포맷 파싱하기** | https://tech.hancom.com/python-hwpx-parsing-1/ | Python HWPX 파싱 튜토리얼 |
| **HWP 포맷 구조 살펴보기** | https://tech.hancom.com/ | HWP 바이너리 포맷 설명 |
| **웹한글 기안기 개발 가이드** | https://developer.hancom.com/webhwp/devguide | 웹한글 API 사용법 |
| **문서 변환 API** | https://developer.hancom.com/docsconverter/guide/api | 문서 변환 API 가이드 |

### 10.3 국가 표준 문서

| 표준 | 설명 | 링크 |
|------|------|------|
| **KS X 6101** | OWPML 공식 표준 문서 | https://standard.go.kr (검색: KS X 6101) |
| **한국산업표준정보망** | 표준 문서 열람 (유료) | https://www.kssn.net |

### 10.4 커뮤니티 및 튜토리얼

| 리소스 | URL | 설명 |
|--------|-----|------|
| **pyhwpx Cookbook** | https://wikidocs.net/book/8956 | HWP 행정업무 자동화 가이드 |
| **NHN Cloud Meetup** | https://meetup.nhncloud.com/posts/311 | HWPX 포맷 살펴보기 |
| **일상의코딩 블로그** | https://pyhwpx.com | pyhwpx 개발자 블로그 |

---

## 11. GitHub 레포지토리

### 11.1 한컴 공식 레포지토리

| 저장소 | 설명 | 언어 |
|--------|------|------|
| **[hwpx-owpml-model](https://github.com/hancom-io/hwpx-owpml-model)** | OWPML 파일 필터 모델 | C++ |
| **[hwpx-contents-extract](https://github.com/hancom-io/hwpx-contents-extract)** | HWPX 텍스트 추출 및 빈도 분석 예제 | Java |
| **[metatag-ex](https://github.com/hancom-io/metatag-ex)** | HWPX 메타태그 추출 | C++ |

### 11.2 Python 라이브러리

| 저장소 | 설명 | 링크 |
|--------|------|------|
| **pyhwpx** | 한글 자동화 고수준 라이브러리 | [GitHub](https://github.com/martiniifun/pyhwpx) |
| **python-hwpx** | HWPX 직접 편집 도구 | [GitHub](https://github.com/airmang/python-hwpx) |
| **pyhwp** | HWP v5 파서 | [GitHub](https://github.com/mete0r/pyhwp) |
| **hwp-automation** | 한글 자동화 튜토리얼 코드 | [GitHub](https://github.com/JSJeong-me/hwp-automation) |
| **hwp-mcp** | Claude AI + 한글 연동 MCP 서버 | [GitHub](https://github.com/jkf87/hwp-mcp) |

### 11.3 Java 라이브러리

| 저장소 | 설명 | 링크 |
|--------|------|------|
| **hwpxlib** | HWPX 파일 읽기/쓰기 | [GitHub](https://github.com/neolord0/hwpxlib) |
| **hwplib** | HWP 파일 처리 | [GitHub](https://github.com/neolord0/hwplib) |
| **hwp2hwpx** | HWP → HWPX 변환 | [GitHub](https://github.com/neolord0/hwp2hwpx) |
| **hwp-converter-api** | HWP 변환 API 서버 | [GitHub](https://github.com/NomaDamas/hwp-converter-api) |

### 11.4 기타 언어

| 저장소 | 설명 | 언어 |
|--------|------|------|
| **hwp.js** | 웹 기반 HWP 뷰어/파서 | JavaScript |
| **hwp-rs** | Rust HWP 라이브러리 | Rust |
| **openhwp** | HWP 뷰어/에디터 올인원 | 다양함 |
| **H2Orestart** | LibreOffice 확장 | Java |

### 11.5 GitHub 토픽 페이지

- [hwpx 토픽](https://github.com/topics/hwpx)
- [hwp 토픽](https://github.com/topics/hwp)

---

## 12. 실용적인 코드 예제

### 12.1 기본 문서 자동화 (pyhwpx)

```python
from pyhwpx import Hwp

# 한글 문서 열기
hwp = Hwp()

# 텍스트 삽입
hwp.insert_text("Hello World!")

# 5x5 표 생성
hwp.create_table(5, 5, treat_as_char=True)

# 표에 데이터 채우기
for i in range(25):
    hwp.insert_text(i)
    hwp.TableRightCell()
```

### 12.2 HWPX 표 데이터 추출 (BeautifulSoup)

```python
import zipfile
from bs4 import BeautifulSoup
import pandas as pd

# HWPX 파일 압축 해제
with zipfile.ZipFile("document.hwpx", "r") as z:
    z.extractall("extracted")

# XML 파싱
with open("extracted/Contents/section0.xml", "r", encoding="utf-8") as f:
    xml_data = f.read()

soup = BeautifulSoup(xml_data, "lxml-xml")

# 표 데이터 추출
tables = soup.find_all("hp:tbl")
table_data = []

for table in tables:
    rows = table.find_all("hp:tr")
    for row in rows:
        row_data = []
        cells = row.find_all("hp:tc")
        for cell in cells:
            text = cell.get_text(strip=True)
            row_data.append(text)
        table_data.append(row_data)

# DataFrame으로 변환 후 CSV 저장
df = pd.DataFrame(table_data)
df.to_csv("output.csv", index=False, encoding="utf-8-sig")
```

### 12.3 표를 DataFrame으로 변환 (pyhwpx)

```python
from pyhwpx import Hwp

hwp = Hwp()
hwp.open("document.hwp")

# 첫 번째 표로 이동
hwp.get_into_nth_table(0)

# 표를 pandas DataFrame으로 변환
df = hwp.table_to_df()
print(df)
```

### 12.4 COM 자동화 (pywin32 직접 사용)

```python
import win32com.client

hwp = win32com.client.Dispatch("HWPFrame.HwpObject")
hwp.RegisterModule("FilePathCheckDLL", "FilePathCheckerModule")  # 보안 모듈
hwp.Open("문서.hwpx")

# 텍스트 삽입
hwp.HAction.GetDefault("InsertText", hwp.HParameterSet.HInsertText.HSet)
hwp.HParameterSet.HInsertText.Text = "자동화 테스트"
hwp.HAction.Execute("InsertText", hwp.HParameterSet.HInsertText.HSet)

hwp.SaveAs("output.hwpx")
hwp.Quit()
```

### 12.5 HWPX 직접 파싱 (표준 라이브러리만 사용)

```python
import zipfile
import xml.etree.ElementTree as ET
from io import BytesIO

def parse_hwpx(file_path: str):
    """HWPX 파일 파싱"""
    with zipfile.ZipFile(file_path, 'r') as zipf:
        # 헤더 정보 읽기
        if 'Contents/header.xml' in zipf.namelist():
            header_bytes = zipf.read('Contents/header.xml')
            header = ET.fromstring(header_bytes)

            # 섹션 수 추출
            section_count = header.get('secCnt')
            print(f"섹션 수: {section_count}")

        # 본문 텍스트 읽기
        if 'Contents/section0.xml' in zipf.namelist():
            section_bytes = zipf.read('Contents/section0.xml')
            section = ET.fromstring(section_bytes)

            # 모든 텍스트 추출
            ns = {'hp': 'http://www.hancom.co.kr/hwpml/2011/paragraph'}
            for t in section.iter():
                if t.tag.endswith('}t') and t.text:
                    print(t.text)

# 사용
parse_hwpx('문서.hwpx')
```

---

## 13. 실무 활용 사례

### 13.1 공공기관/행정업무

- **인사발령 통보서 자동 생성**: 엑셀 명단을 기반으로 개인별 통보서 대량 생성
- **보고서 취합**: 여러 hwp 파일에서 특정 데이터 추출 및 통합
- **문서 서식 일괄 변경**: 자간, 글꼴, 여백 등 일괄 조정
- **결재 문서 자동화**: 템플릿 기반 결재 문서 생성

### 13.2 데이터 분석/처리

- **HWPX 텍스트 마이닝**: 키워드 빈도 분석, 텍스트 랭킹
- **표 데이터 추출**: HWPX 내 표를 CSV/Excel로 변환
- **문서 메타데이터 분석**: 작성자, 수정일 등 정보 추출
- **대량 문서 검색**: 특정 키워드 포함 문서 필터링

### 13.3 AI 연동

- **ChatGPT/Claude 연동**: 문서 내용 분석 및 자동 수정
- **HWP-MCP**: Claude AI와 한글 문서 직접 연동
- **자동 요약/번역**: 문서 내용 추출 후 AI 처리
- **문서 분류**: 기계학습을 통한 자동 분류

### 13.4 문서 변환 및 아카이빙

- **장기 보존**: HWP → HWPX 변환으로 개방형 포맷 보존
- **웹 게시**: HWPX → HTML 변환 후 웹 게시
- **PDF 생성**: 인쇄용 PDF 자동 생성

---

## 14. 주요 제한사항 및 주의사항

### 14.1 플랫폼 및 환경 제한

| 제한사항 | 설명 |
|----------|------|
| **OS 의존성** | pyhwpx는 Windows + 한글 프로그램 설치 필요 |
| **버전 호환성** | HWPX는 한글 2010 이하 버전에서 열기 불가 |
| **일부 시스템 미지원** | 일부 관공서 시스템에서 HWPX 인식 안됨 |
| **뷰어 호환성** | 안드로이드 한컴오피스 뷰어 등 일부 뷰어 미지원 |

### 14.2 기능 제한

| 제한사항 | 설명 |
|----------|------|
| **DRM/암호화** | 암호화된 문서는 별도 처리 필요 |
| **매크로** | HWPX에서 매크로 기능 제약 존재 |
| **복잡한 레이아웃** | 복잡한 도형, 개체 포함 문서의 호환성 이슈 |
| **일부 기능 미문서화** | 일부 고급 기능은 공식 문서화 안됨 |

### 14.3 파싱 시 주의사항

- **네임스페이스**: 문서 버전에 따라 네임스페이스가 달라질 수 있음
- **표 안의 텍스트**: pyhwp 등 일부 라이브러리에서 표 내 텍스트 추출 제한
- **미리보기 텍스트**: PrvText는 약 2페이지까지만 포함
- **폰트 문제**: 변환 시 일부 폰트가 지원되지 않아 원본과 차이 발생 가능

### 14.4 보안 관련

- **HWP 보안 취약점**: OLE 개체 악용, 플래시 취약점 등 과거 발견됨
- **HWPX의 이점**: XML 기반으로 악성코드 탐지 용이
- **주의**: OLE 개체 등 바이너리 데이터 포함 시 유사한 취약점 존재 가능

### 14.5 권장 사항

| 상황 | 권장 |
|------|------|
| **새 문서 작성** | HWPX 형식 사용 권장 |
| **장기 보존 문서** | HWPX 형식으로 저장 권장 |
| **문서 공유** | 상대방의 한글 버전 확인 후 적절한 형식 선택 |
| **변환 후** | 품질 확인 필수 |

---

## 참고 링크 모음

### 공식 리소스
- [한컴테크 HWPX 포맷 구조](https://tech.hancom.com/hwpxformat/)
- [한컴테크 Python HWPX 파싱](https://tech.hancom.com/python-hwpx-parsing-1/)
- [한컴디벨로퍼](https://developer.hancom.com)
- [한컴 GitHub](https://github.com/hancom-io)
- [KS X 6101 표준](https://standard.go.kr)

### Python 라이브러리
- [PyPI - pyhwpx](https://pypi.org/project/pyhwpx/)
- [PyPI - pyhwp](https://pypi.org/project/pyhwp/)
- [PyPI - libhwp](https://pypi.org/project/libhwp/)
- [pyhwpx Cookbook](https://wikidocs.net/book/8956)

### GitHub
- [pyhwpx](https://github.com/martiniifun/pyhwpx)
- [python-hwpx](https://github.com/airmang/python-hwpx)
- [hwpxlib](https://github.com/neolord0/hwpxlib)
- [hwp2hwpx](https://github.com/neolord0/hwp2hwpx)
- [hwpx-owpml-model](https://github.com/hancom-io/hwpx-owpml-model)
- [hwpx-contents-extract](https://github.com/hancom-io/hwpx-contents-extract)

### 온라인 변환 도구
- [PolarisOffice Tools](https://www.polarisofficetools.com)
- [Vertopal](https://www.vertopal.com)
- [ONLYOFFICE](https://www.onlyoffice.com)

---

*이 문서는 2025년 1월 기준으로 작성되었습니다.*
